echo "Running lint-staged (format + lint on staged files)..."
npx --no lint-staged || exit 1

echo "Running ESLint..."
yarn lint || exit 1

echo "Running TypeScript check..."
yarn typecheck || exit 1

# Optionally build on commit (disabled by default). Enable with RUN_BUILD_ON_COMMIT=1
if [ "${RUN_BUILD_ON_COMMIT:-0}" = "1" ]; then
echo "Building project (RUN_BUILD_ON_COMMIT=1)..."
rm -rf .next
yarn build || exit 1
fi

yarn test
